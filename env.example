# happy-stacks environment (template)
#
# Copy to `.env` (recommended) and adjust as needed:
#
#   cp env.example .env
#
# Notes:
# - `HAPPY_STACKS_*` is the canonical prefix.
# - `HAPPY_LOCAL_*` is still supported as a legacy alias (via automatic mapping).

# -----------------------------------------------------------------------------
# Core (server)
# -----------------------------------------------------------------------------

# Main server URL shown/used by the CLI (QR/login links, etc).
# For local use: http://localhost:3005
# For Tailscale (recommended): set this to your HTTPS Serve URL, e.g. https://<machine>.<tailnet>.ts.net
HAPPY_STACKS_SERVER_URL=http://localhost:3005

# Server port (main stack)
HAPPY_STACKS_SERVER_PORT=3005

# Which server component to use by default:
# - happy-server-light (default)
# - happy-server
HAPPY_STACKS_SERVER_COMPONENT=happy-server-light

# -----------------------------------------------------------------------------
# What to run
# -----------------------------------------------------------------------------

# UI build + serving (when using happy-server-light)
HAPPY_STACKS_UI_PREFIX=/
HAPPY_STACKS_SERVE_UI=1

# Components
HAPPY_STACKS_UI=1
HAPPY_STACKS_DAEMON=1

# Setup behavior (bootstrap)
HAPPY_STACKS_NPM_LINK=1
HAPPY_STACKS_CLI_BUILD=1

# -----------------------------------------------------------------------------
# Storage / paths
# -----------------------------------------------------------------------------

# Canonical storage root for stacks (new):
HAPPY_STACKS_STORAGE_DIR=~/.happy/stacks

# Optional overrides for the main stack:
HAPPY_STACKS_UI_BUILD_DIR=~/.happy/stacks/main/ui
HAPPY_STACKS_CLI_HOME_DIR=~/.happy/stacks/main/cli

# When creating new stacks, auto-pick ports starting from here:
HAPPY_STACKS_STACK_PORT_START=3005

# -----------------------------------------------------------------------------
# Git cloning defaults (bootstrap)
# -----------------------------------------------------------------------------

# Default clone source for missing components:
# - forks (default)
# - upstream
HAPPY_STACKS_REPO_SOURCE=forks

# Optional: override repo URLs
# HAPPY_STACKS_UI_REPO_URL=
# HAPPY_STACKS_CLI_REPO_URL=
# HAPPY_STACKS_SERVER_LIGHT_REPO_URL=
# HAPPY_STACKS_SERVER_FULL_REPO_URL=

# Disable auto-cloning missing component repos:
# HAPPY_STACKS_CLONE_MISSING=0

# -----------------------------------------------------------------------------
# Tailscale Serve automation (optional)
# -----------------------------------------------------------------------------

# Optional: expose UI over HTTPS using Tailscale Serve (recommended for remote access)
HAPPY_STACKS_TAILSCALE_SERVE=0
HAPPY_STACKS_TAILSCALE_SERVE_PATH=/
HAPPY_STACKS_TAILSCALE_UPSTREAM=http://127.0.0.1:3005
HAPPY_STACKS_TAILSCALE_RESET_ON_EXIT=0
HAPPY_STACKS_TAILSCALE_PREFER_PUBLIC_URL=1

# Optional: how long `pnpm start` should wait for Tailscale at boot (ms)
HAPPY_STACKS_TAILSCALE_WAIT_MS=15000

# If `tailscale` is not on PATH (common if you use the macOS app), set this:
HAPPY_STACKS_TAILSCALE_BIN=/Applications/Tailscale.app/Contents/MacOS/Tailscale

# -----------------------------------------------------------------------------
# Worktree UX (optional)
# -----------------------------------------------------------------------------

# Preferred terminal / shell for `pnpm wt shell` and SwiftBar actions:
# HAPPY_STACKS_WT_TERMINAL=auto
# HAPPY_STACKS_WT_SHELL=/bin/zsh

# -----------------------------------------------------------------------------
# Tauri build (optional)
# -----------------------------------------------------------------------------

HAPPY_STACKS_BUILD_TAURI=0
HAPPY_STACKS_TAURI_DEBUG=1
HAPPY_STACKS_TAURI_IDENTIFIER=com.happy.stacks
HAPPY_STACKS_TAURI_PRODUCT_NAME="Happy Stacks"

# Optional overrides:
# HAPPY_STACKS_TAURI_SERVER_URL=
# HAPPY_STACKS_TAURI_PREFER_TAILSCALE=1

# -----------------------------------------------------------------------------
# Mobile app (iOS) (optional)
# -----------------------------------------------------------------------------
#
# These are used by `pnpm mobile:*` commands.
# Recommended if you plan to install a release build onto a real iPhone.
#
# - For real devices: use a bundle identifier you own (Apple dev portal).
# - `HAPPY_STACKS_SERVER_URL` is automatically baked into the app as EXPO_PUBLIC_HAPPY_SERVER_URL when building.
#
# Example:
# HAPPY_STACKS_IOS_BUNDLE_ID=com.yourname.happy.local.dev
# HAPPY_STACKS_IOS_APP_NAME="Happy Local"
#
# Optional: override how Metro is started / which scheme is used for QR launching:
# HAPPY_STACKS_MOBILE_HOST=lan
# HAPPY_STACKS_MOBILE_PORT=8081
# HAPPY_STACKS_MOBILE_SCHEME=com.yourname.happy.local.dev

# -----------------------------------------------------------------------------
# Optional: server-light metrics (upstream component feature; not used by happy-stacks scripts)
# -----------------------------------------------------------------------------

METRICS_ENABLED=false
METRICS_PORT=9090

